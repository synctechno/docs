# SOME DESCRIPTIVE TITLE.
# Copyright (C) 2016-2022, Deciso B.V
# This file is distributed under the same license as the OPNsense package.
# FIRST AUTHOR <EMAIL@ADDRESS>, 2022.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: OPNsense Wiki & Documentation<br/><small>351a8e2\n"
"Report-Msgid-Bugs-To: EMAIL@ADDRESS\n"
"POT-Creation-Date: 2022-01-14 13:26+0900\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=utf-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Generated-By: Babel 2.9.1\n"

#: ../../source/manual/how-tos/carp.rst:4
msgid "Configure CARP"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:9
msgid "Overview"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:11
msgid ""
"One of the more powerful features of OPNsense is to set-up a redundant "
"firewall with automatic fail-over option. This chapter describes step by "
"step how to create a set-up based on two networks. The 192.168.1.0/24 "
"will be used for the internal network and 172.18.0.0/24 will be used to "
"route our traffic to the internet."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:20
msgid ""
"When using CARP ( `FreeBSD handbook on CARP "
"<https://www.freebsd.org/doc/handbook/carp.html>`__ ), all fail-safe "
"interfaces should have a dedicated IP address which will be combined with"
" one shared virtual IP address to communicate to both networks. In the "
"picture above the dashed lines are used to mark the virtual addresses."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:26
msgid ""
"The configuration file (XML) for both firewalls can be downloaded from "
"the wiki."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:31
msgid "Terminology"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:33
msgid ""
"There is some terminology involved in setting up a CARP cluster, which we"
" will explain briefly first:"
msgstr ""

msgid "CARP"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:39
msgid ""
"Common Address Redundancy Protocol uses IP protocol 112, is derived from "
"OpenBSD and uses multicast packets to signal its neighbours about its "
"status. Always make sure that each interface can receive CARP packets. "
"Every virtual interface must have a unique Virtual Host ID (vhid), which "
"is shared across the physical machines. To determine which physical "
"machine has a higher priority, the advertised skew is used. A lower skew "
"means a higher score. (our master firewall uses 0)."
msgstr ""

msgid "pfSync"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:51
msgid ""
"Together with CARP, we can use pfSync to replicate our firewalls state. "
"When failing over you need to make sure both machines know about all "
"connections to make the migration seamless. It's highly advisable to use "
"a dedicated interface for pfSync packets between the hosts, both for "
"security reasons (state injection) as for performance."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:58
msgid ""
"When using different network drivers on both machines, like running a HA "
"setup with one physical machine as master and a virtual machine as slave,"
" states can not be synced as interface names differ. The only workaround "
"would be to set up a LAGG."
msgstr ""

msgid "XMLRPC sync"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:66
msgid ""
"OPNsense includes a mechanism to keep the configuration of the backup "
"server in sync with the master. This mechanism is called XMLRPC sync and "
"can be found under :menuselection:`System --> High Availability --> "
"Settings`."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:72
msgid "Setup interfaces & basic firewall rules"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:75
msgid ""
"Make sure the interface assignments on both systems are identical! Via "
":menuselection:`Interfaces --> Overview` you can check if e.g. DMZ is "
"opt1 on both machines. When the assigments differ you will have mixed "
"Master and Backup IPs on both machines."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:80
msgid "Our example uses three interfaces, which all have a rather basic setup."
msgstr ""

msgid "Master"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:86
msgid ""
"Go to interfaces, make sure you have all three interfaces assigned and "
"setup the following addresses and subnets:"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:90
msgid "LAN 192.168.1.10/24"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:92
msgid "WAN 172.18.0.101/24"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:94
msgid "PFSYNC 10.0.0.1"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:97
msgid ""
"Next we need to make sure the appropriate protocols can be used on the "
"different interfaces, go to :menuselection:`Firewall --> Rules` and make "
"sure both LAN and WAN accept at least CARP packets (see protocol "
"selection). Because we're connecting both firewalls using a direct cable "
"connection, we will add a single rule to accept all traffic on all "
"protocols for that specific interface. Another option is to only accept "
"traffic to the GUI port and pfSync protocol."
msgstr ""

msgid "Backup"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:108
msgid "The backup server needs its own dedicated addresses, we will use these:"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:111
#: ../../source/manual/how-tos/carp.rst:159
msgid "LAN"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:111
msgid "192.168.1.20/24"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:113
#: ../../source/manual/how-tos/carp.rst:141
#: ../../source/manual/how-tos/carp.rst:189
msgid "WAN"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:113
msgid "172.18.0.102/24"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:115
msgid "PFSYNC"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:115
msgid "10.0.0.2"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:119
msgid ""
"Per default the dropdown menu for subnet mask only fits for IPv4 "
"addresses (up to 32). If you want to add an IPv6 CARP address, write you "
"v6 address and the dropdown list will auto-update to itself up to 128."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:124
msgid ""
"Because we are going to synchronize firewall settings between both hosts,"
" we only need to make sure that the pfSync interface can accept data from"
" the master for the initial setup. Use the same rule as used for the "
"master on this interface."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:131
msgid "Setup Virtual IPs"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:133
msgid ""
"On the master node we are going to setup our Virtual IP addresses, which "
"will also be added to the backup node with a higher skew after "
"synchronisation. Go to :menuselection:`Interfaces --> Virtual IPs` and "
"add a new one with the following characteristics:"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:139
#: ../../source/manual/how-tos/carp.rst:157
msgid "Type"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:139
#: ../../source/manual/how-tos/carp.rst:157
msgid "Carp"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:141
#: ../../source/manual/how-tos/carp.rst:159
#: ../../source/manual/how-tos/carp.rst:189
msgid "Interface"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:143
#: ../../source/manual/how-tos/carp.rst:161
msgid "IP addresses"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:143
msgid "172.18.0.100 / 24"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:145
#: ../../source/manual/how-tos/carp.rst:163
msgid "Virtual password"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:145
#: ../../source/manual/how-tos/carp.rst:163
msgid "opnsense (the example uses this)"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:147
#: ../../source/manual/how-tos/carp.rst:165
msgid "VHID Group"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:147
msgid "1"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:149
#: ../../source/manual/how-tos/carp.rst:167
msgid "Advertising Frequency"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:149
#: ../../source/manual/how-tos/carp.rst:167
msgid "Base 1 / Skew 0"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:151
#: ../../source/manual/how-tos/carp.rst:169
msgid "Description"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:151
msgid "VIP WAN"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:154
msgid "And another using the following:"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:161
msgid "192.168.1.1 / 24"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:165
msgid "3"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:169
msgid "VIP LAN"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:174
msgid "Setup outbound NAT"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:176
msgid ""
"When traffic is going out of the firewall it should also use the virtual "
"IP address on the WAN interface to make seamless transitions possible. "
"The default NAT configuration is for OPNsense is to use Automatic "
"outbound NAT rule generation using the WAN interface's IP address for "
"outgoing connections. This will not allow seamless transitions and needs "
"to be changed to the WAN VIP."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:183
msgid ""
"Go to :menuselection:`Firewall --> NAT --> Outbound`. Choose manual "
"outbound nat rule generation. On this page create the a rule originating "
"from the 192.168.1.0/24 network to use the CARP virtual interface "
"(172.18.0.100). The rule should contain the following:"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:191
msgid "Source addresss"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:191
msgid "LAN net (192.168.1.0/24)"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:193
msgid "Translation / target"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:193
msgid "172.18.0.100 (CARP virtual IP)"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:198
msgid "(optional) Setup DHCP server"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:200
msgid ""
"When using DHCP for the local area network, there are some things to "
"consider. All clients should use the virtual address instead of the "
"physical address it's normally propagating. Next thing to consider is "
"there will be two servers active at the same time, which should know of "
"each others pools. If DNS requests are also forwarded by OPNsense, make "
"sure the DHCP server sends the right IP address. These are settings used "
"in our example (on the master server):"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:209
msgid "DNS servers"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:209
#: ../../source/manual/how-tos/carp.rst:211
msgid "192.168.1.1"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:211
msgid "Gateway"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:213
msgid "Failover peer IP"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:213
msgid "192.168.1.20"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:218
msgid "Setup pfSync and HA sync (xmlrpc)"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:220
msgid ""
"First we should configure pfSync to synchronize the connection state "
"tables and HA sync (xmlrpc) on the master firewall. Go to "
":menuselection:`System --> High Availability --> Settings` and enable "
"pfSync by activating the `Synchronize States` checkbox, selecting PFSYNC "
"for the `Synchronize Interface` and enter the peer IP (10.0.0.2) in the "
"field `Synchronize Peer IP`."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:227
msgid ""
"To synchronize the configuration settings from the master to the backup "
"firewall, we setup the XMLRPC sync. In the `Synchronize Config to IP` "
"field we enter the peer IP (10.0.0.2) of the PFSYNC interface again to "
"keep this traffic on the direct connection between the two firewalls. Now"
" we need to enter the remote user name and password and configure the "
"settings we want to duplicate to the backup server. For our setup we will"
" enable the following:"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:235
msgid "Synchronize rules"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:237
msgid "Synchronize NAT"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:239
msgid "Synchronize DHCPD"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:241
msgid "Synchronize Virtual IPs"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:244
msgid ""
"After this we configure pfSync on the backup firewall. Go to "
":menuselection:`System --> High Availability --> Settings` and enable "
"pfSync by activating the `Synchronize States` checkbox, selecting PFSYNC "
"for the `Synchronize Interface` and enter the master IP (10.0.0.1) in the"
" field `Synchronize Peer IP`. Do not configure XMLRPC sync on the backup "
"firewall."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:252
msgid "Finalize setup"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:254
msgid ""
"Just to make sure all settings are properly applied, reboot both "
"firewalls before testing."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:259
msgid "Testing setup"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:261
msgid ""
"First go to :menuselection:`System --> High availability --> Status` in "
"the OPNsense webinterface and check if both machines are properly "
"initialized."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:264
msgid ""
"To test our setup, we will connect a client to the local area network and"
" open a ssh connection to a host behind both firewalls. Now when "
"connected you should be able to look at the state table on both OPNsense "
"firewalls (:menuselection:`Firewall --> Diagnostics --> States Dump`) and"
" they should both display the same connection. Next try to pull the "
"network plug from the master firewall and it should move over to the "
"backup without loosing (or freezing) the ssh connection."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:274
msgid "Adding multiple CARP IPs"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:276
msgid ""
"If your provider offers you a subnet of public IP addresses and you want "
"to expose them for NAT or different services running on your Firewall, "
"you will also have to add them to your HA setup. Since adding a VHID for "
"every IP would make the CARP traffic very noisy, you can also add a new "
"IP Alias and choose the correct VHID where the first CARP IP is "
"configured."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:284
msgid ""
"IP Alias is not synchronized to slave, be sure to also add it to your "
"second machine."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:289
msgid "Example: Updating a CARP HA Cluster"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:291
msgid ""
"Running a redundant Active/Passive cluster leads to the expectation to "
"have zero downtime. To keep the downtime at a minimum when running "
"updates just follow these steps:"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:295
msgid "Update your secondary unit and wait until it is online again"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:296
msgid ""
"On your primary unit go to :menuselection:`Interfaces --> Virtual IPs -->"
" Status` and click **Enter Persistent CARP Maintenance Mode**"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:297
msgid ""
"You secondary unit is now *MASTER*, check if all services like DHCP, VPN,"
" NAT are working correctly"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:298
msgid ""
"If you ensured the update was fine, update your primary unit and hit "
"**Leave Persistent CARP Maintenance Mode**"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:300
msgid ""
"With these steps you will not lose too many packets and your existing "
"connection will be transferred as well. Also note that entering "
"persistent mode survives a reboot."
msgstr ""

#: ../../source/manual/how-tos/carp.rst:305
msgid "Resources"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:307
msgid ""
"Configuration for master server ( :download:`Carp_example_master.xml "
"<resources/Carp_example_master.xml>` )"
msgstr ""

#: ../../source/manual/how-tos/carp.rst:308
msgid ""
"Configuration for backup server ( :download:`Carp_example_backup.xml "
"<resources/Carp_example_backup.xml>` )"
msgstr ""

